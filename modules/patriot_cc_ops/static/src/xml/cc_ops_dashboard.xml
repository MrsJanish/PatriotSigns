<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="patriot_cc_ops.Dashboard">
        <div t-attf-class="o_cc_dashboard #{themeClass}">
            <!-- Aurora Canvas -->
            <canvas t-if="state.theme === 'aurora'" id="ccAuroraCanvas" class="cc-aurora-canvas"/>
            
            <!-- Splash Gradients -->
            <t t-if="state.theme === 'splash'">
                <div class="cc-gradient cc-grad-1"/>
                <div class="cc-gradient cc-grad-2"/>
                <div class="cc-gradient cc-grad-3"/>
            </t>
            
            <!-- Theme Toggle -->
            <button class="cc-theme-btn" t-on-click="toggleTheme">
                <t t-if="state.theme === 'aurora'">‚òÄÔ∏è Light</t>
                <t t-else="">üåå Aurora</t>
            </button>
            
            <!-- Main Container -->
            <div class="cc-container">
                <!-- Header -->
                <div class="cc-header">
                    <h1><span>Construct</span>Connect</h1>
                    <input type="text" class="cc-search" placeholder="Search projects..." 
                           t-att-value="state.searchQuery" t-on-input="onSearch"/>
                </div>
                
                <!-- Loading -->
                <div t-if="state.loading" class="cc-loading">
                    <div class="cc-spinner"/>
                </div>
                
                <!-- Empty -->
                <div t-if="!state.loading and filteredProjects.length === 0" class="cc-empty">
                    <h3>No Projects Found</h3>
                    <p>Forward ITB emails from ConstructConnect to start tracking.</p>
                </div>
                
                <!-- Projects -->
                <div t-if="!state.loading and filteredProjects.length > 0" class="cc-grid">
                    <t t-foreach="filteredProjects" t-as="p" t-key="p.id">
                        <div t-attf-class="cc-card #{isExpanded(p.id) ? 'expanded' : ''}"
                             t-on-click="() => this.toggleExpand(p.id)">
                            <!-- Header -->
                            <div class="cc-card-head">
                                <h4 t-esc="p.name"/>
                                <div class="cc-meta">
                                    <span>üìç <t t-esc="p.city || '‚Äî'"/></span>
                                    <span>üìÖ <t t-esc="formatDate(p.bid_date)"/></span>
                                    <span class="cc-badge" t-att-data-state="p.state">
                                        <t t-esc="p.state || 'new'"/>
                                    </span>
                                </div>
                            </div>
                            <!-- Expanded -->
                            <div class="cc-card-body">
                                <div class="cc-details">
                                    <div><label>Project #</label><span t-esc="p.project_number || '‚Äî'"/></div>
                                    <div><label>Est. Value</label><span t-esc="formatCurrency(p.estimated_value)"/></div>
                                    <div><label>GC</label><span t-esc="p.gc_name || '‚Äî'"/></div>
                                    <div><label>Owner</label><span t-esc="p.owner_name || '‚Äî'"/></div>
                                    <div><label>Documents</label><span><t t-esc="p.document_count || 0"/> files</span></div>
                                </div>
                                <button class="cc-btn" t-on-click.stop="() => this.openProject(p.id)">
                                    Open Project ‚Üí
                                </button>
                            </div>
                        </div>
                    </t>
                </div>
            </div>
        </div>
    </t>

</templates>
